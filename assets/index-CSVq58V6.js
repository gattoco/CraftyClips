import{c as u,e as g,o as y,j as C,g as m,t as p,u as E,r as x,v as h,i as U,b as $}from"./index-DOlaBTxZ.js";import{c as L}from"./twitch-B1AAW--y.js";var b=p("<video id=video-player style=width:100%;height:100%;position:absolute;top:0;left:0;z-index:-1; autoplay>"),_=p("<p>No clips to play.");const w=t=>{const[l,a]=u(0),[v,c]=u(null),s=()=>t.clips[l()],i=()=>l()<t.clips.length-1?t.clips[l()+1]:null,o=()=>{l()<t.clips.length-1?a(l()+1):(console.log("End of queue, restarting from the first clip."),a(0))},r=async e=>await L(e)||"",d=async()=>{const e=i();if(e){const n=await r(e.id);c(n),console.log(`Preloading next video URL: ${n}`)}};return g(async()=>{const e=s();if(e){const n=document.getElementById("video-player");n&&(n.src=await r(e.id),n.muted=!0,n.play().catch(f=>{console.error(`Error starting playback for clip ${e.id}:`,f)}),n.addEventListener("loadeddata",d,{once:!0}))}}),y(()=>{const e=document.getElementById("video-player");e&&(e.addEventListener("ended",o),e.addEventListener("error",o))}),C(()=>{const e=document.getElementById("video-player");e&&(e.removeEventListener("ended",o),e.removeEventListener("error",o))}),m(()=>m(()=>!!s())()?(()=>{var e=b();return e.controls=!1,e.muted=!0,e})():_())};var B=p("<div>");const D=()=>{const{state:t,setState:l}=E(),a=x(),c=h().pathname,s=i=>{if(!i)return t.clips;c.includes("brb");const o=t.clipQueue.find(r=>r.id===i);return o?o.clips.map(r=>t.clips.find(d=>d.id===r)).filter(r=>!!r):t.clips};return(()=>{var i=B();return U(i,$(w,{get clips(){return s(a.id)}})),i})()};export{D as default};
