import{f as v,c as g,o as E,h as C,e as u,b as h,l as x,t as p,u as y,v as $,i as b,a as L}from"./index-D4UxCZ1N.js";var _=p("<video id=video-player style=width:100%;height:100%;position:absolute;top:0;left:0;z-index:-1; autoplay>"),U=p("<p>No clips to play.");const B=n=>{const[o,c]=v(0),i=()=>n.clips[o()],a=()=>o()<n.clips.length-1?n.clips[o()+1]:null,s=()=>{o()<n.clips.length-1?c(o()+1):(console.log("End of queue, restarting from the first clip."),c(0))},r=e=>{const t=e.replace("-preview-480x272.jpg",".mp4");return console.log(`Extracted video URL: ${t}`),t},d=()=>{const e=document.getElementById("video-player");e&&(e.addEventListener("ended",s),e.addEventListener("error",t=>{console.error(`Error loading video for clip ${i()?.id} at index ${o()}:`,t),s()}))},m=()=>{const e=a(),t=e?r(e.thumbnail_url):null;if(t){console.log(`Preloading next video URL: ${t}`);const l=document.createElement("link");return l.rel="preload",l.as="video",l.href=t,document.head.appendChild(l),()=>{document.head.removeChild(l),console.log(`Removed preload for: ${t}`)}}};return g(()=>{const e=i();e&&console.log(`Playing clip at index ${o()}:`,e);const t=m(),l=document.getElementById("video-player");return l&&(l.src=r(i().thumbnail_url),l.play().catch(f=>{console.error(`Error starting playback for clip ${i()?.id}:`,f)})),()=>{t?.()}}),E(()=>{d()}),C(()=>{const e=document.getElementById("video-player");e&&(e.removeEventListener("ended",s),e.removeEventListener("error",s))}),u(()=>u(()=>!!i())()?(()=>{var e=_();return e.controls=!1,e.muted=!1,h(()=>x(e,"src",r(i().thumbnail_url))),e})():U())};var I=p("<div>");const R=()=>{const{state:n,setState:o}=y(),c=$(),i=a=>{if(!a)return n.clips;const s=n.clipQueue.find(r=>r.id===a);return s?s.clips.map(r=>n.clips.find(d=>d.id===r)).filter(r=>!!r):n.clips};return(()=>{var a=I();return b(a,L(B,{get clips(){return i(c.id)}})),a})()};export{R as default};
